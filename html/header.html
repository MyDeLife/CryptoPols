<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../styles/header.css">
    <link rel="stylesheet" href="../styles/global.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">

    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" crossorigin="anonymous"></script>

</head>

<header>
    <div id="header-content">
        <div class="logo-title">
            <a id="CPlogo-header" href="https://cryptopols.com/"><img id="CP-img-header"
                    src="https://github.com/MyDeLife/CryptoPols/blob/main/assets/CP%20Logo%20wo%202048.png?raw=true"></a>
            <div id="header-title">
                <h1>Crypto<span>Pols</span></h1>
                <p>...monitoring crypto sentiment of US politicians in Congress</p>
            </div>
        </div>

        

        <nav>
            <div class="nav-dropdown">
                <p class="nav-bar"><a href="https://cryptopols.com/">Home</a></p>
            </div>

            <!-- <div class="nav-dropdown">
                <p class="nav-bar">State</p>
                <div class="nav-dropdown-content">
                    <a href="state1.html">State 1</a>
                    <a href="state2.html">State 2</a>
                    <a href="state3.html">State 3</a>
                </div>
            </div>
        

            <div class="nav-dropdown">
                <p class="nav-bar no-cursor">Politician</p>
                <div class="nav-dropdown-content">
                </div>
            </div>

            -->

            <div class="nav-dropdown">
                <p class="nav-bar no-cursor"><a>About</a></p>
                <div class="nav-dropdown-content">
                    <!-- <a href="state1.html">Team</a> -->
                    <a href="https://cryptopols.com/html/methodology.html">Methodology</a>
                    <a href="https://www.indiegogo.com/project/preview/02f99799#/">Support CryptoPols</a>
                </div>
            </div>
            <!-- contact button & contact section (must include - in all html) -->
            <button id="contact-button">give feedback</button>
            
            
            <section class="contact" id="contact">
                <div class="close-button-area" id="close-button-area">
                    <button id="close-button" type="submit"><i class="fas fa-window-close"></i></button>
                </div>
                <div class="column right contact-us">
            
                    <div class="text" id="contact-us-text">Give Feedback</div>
                    <form id="contactForm">
                        <div class="fields">
                            <div class="field name">
                                <input type="text" name="name" placeholder="*Name" required>
                            </div>
                            <div class="field email">
                                <input type="email" name="email" placeholder="Email (optional)">
                            </div>
                        </div>
                        <div class="field">
                            <input type="text" name="subject" placeholder="*Subject" required>
                        </div>
                        <div class="field textarea">
                            <textarea cols="30" rows="10" name="message" placeholder="*Message..." required></textarea>
                        </div>
                        <div class="button-area" id="send-message-btn-area">
                            <button id="send-message-btn" type="submit">Send <i class="fas fa-paper-plane"></i></button>
            
                            <div id="responseMessage" style="display:none;"></div>
                        </div>
                    </form>
                </div>
            </section>
            <script>
                $(document).ready(function () {
                    $('#contactForm').on('submit', function (event) {
                        event.preventDefault();

                        var formData = new FormData(event.target);
                        var request = new XMLHttpRequest();

                        request.onreadystatechange = function () {
                            if (request.readyState === 4) {
                                var responseMessage = $('#responseMessage');
                                if (request.status === 200) {
                                    responseMessage.text('Email to CryptoPols sent successfully!');
                                    disableFormFields();
                                    document.getElementById('send-message-btn').style.display = 'none';
                                } else {
                                    responseMessage.text('An error occurred while sending the email. Please try again later.');
                                    document.getElementById('send-message-btn').style.display = 'none';
                                }
                                responseMessage.show();
                            }
                        };

                        request.open('POST', 'send_email.php');
                        request.send(formData);
                    });

                    function disableFormFields() {
                        var formElements = document.getElementById("contactForm").elements;
                        for (var i = 0; i < formElements.length; i++) {
                            if (formElements[i].id !== 'send-message-btn') {
                                formElements[i].disabled = true;
                            }
                        }
                    }

                    $('#contact-button').on('click', function () {
                        $('.contact').addClass('visible contact-form-scaled');
                        $(this).hide();
                    });

                    $('#close-button').on('click', function () {
                        $('.contact').removeClass('visible contact-form-scaled');
                        $('#contact-button').show();
                        enableFormFields();
                    });


                    function enableFormFields() {
                        var formElements = document.getElementById("contactForm").elements;
                        for (var i = 0; i < formElements.length; i++) {
                            formElements[i].disabled = false;
                        }

                        // Reset the form
                        var form = document.getElementById('contactForm');
                        form.reset();

                        // Hide the response message and reset its text
                        var responseMessage = document.getElementById('responseMessage');
                        responseMessage.style.display = 'none';
                        responseMessage.textContent = '';

                        // Show the send button
                        document.getElementById('send-message-btn').style.display = 'block';
                    }
                });
            </script>
        </nav>
    </div>
</header>

<body>

</body>

</html>